<!DOCTYPE HTML>
<html lang="ru">
<head>
  <title>Типы данных</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="../../style/style.css">
</head>
<body>
Перед вами переработанное издание статьи, включающее в себя все последнюю информацию о типах данных в SB.

Новички зачастую не сразу понимают, что означают Integer values, что такое String и т.п. Им и посвящена данная статья. Условно, те типы данных (Data Types), которые используются в SB можно разделить на **числа** и **строки**. Базовым видом данных являются числа. Они, как известно, бывают двух видов: **целые** и **дробные**. Важное замечание: отличие между ними состоит не столько в значении самого числа, сколько в его записи. Так число 5.0 с точки зрения математики есть число целое. Однако в скриптах оно будет именоваться дробным, или числом с плавающей точкой (floating-point value). Все числа, которые имеют в своем написании точку, являются дробными. Пример:

```sb3
50.001
-10.750
0.0
```

Для чисел между -1 и 1 можно не писать 0 в начале. Т.е. 0.0 равнозначно .0\
\
Поскольку способ записи числа имеет значение, то возможны ошибки, когда скриптер забывает написать точку. Компилятор в таком случае расценивает число как целое. Не вдаваясь в отдельные подробности, скажу, что значение этого числа будет немного изменено вследствие этого. В игре после этого могут появиться проблемы. Поэтому следите за этим обстоятельством.
Некоторые опкоды в игре требуют именно применения дробных значений. Это касается скорости движения отдельных объектов, здоровья, брони и т.п. Поэтому старайтесь точно узнать, какой именно тип необходимо использовать.

Sanny Builder в данном случае может помочь вам: внутри классов можно вызвать подсказку, о типах параметров. Подсказка появляется автоматически, когда вы ставите скобку после имени члена класса:

```sb3
Car.PutAt(
```

Вы увидете, что 2й, 3й, 4й параметры имеют тип **Float**. Также подсказку для данного члена класса можно вызвать в любое время нажатием **Ctrl+Shift+Space**.

```sb3
Car.PutAt($Car, {нажмите Ctrl+Shift+Space здесь} )
```

Похожий тип данных - это **хендл (handle)**. Строго говоря это простое число, которое представляет собой указатель на какой-либо объект в памяти игры. Опять-таки, опуская подробности, скажу, что хендл - это "имя" объекта (машины, актера и т.п.). По данному имени вы можете обратиться к объекту и производить над ним определенные действия. Хендлы содержатся в переменных целого типа (Integer values). Их содержимое заполняется после использования специального опкода - конструктора. В SB почти в каждом классе есть такой конструктор.
Имеются ввиду классы опкодов для динамических объектов, которые создаются непосредственно в игре. Например актер (actor), игрок (player), объект (object) и т.д. Нединамические объекты (гаражи) или некоторые отдельные виды объектов, которые не создаются в ходе игры (модели), такого конструктора не имеют. Конструктор имеет одинаковое для всех классов имя - Create. После его срабатывания игра создает в памяти указатель на новый объект и записывает его в переменную:

```sb3
$ActorHandle = Actor.Create(CivMale, #MALE01, 0.0, 0.0, 0.0)
```

Теперь хендл актера хранится в переменной `$ActorHandle`, и вы можете, используя ее, делать с ним все, что угодно. Хендл можно получить не только создавая нового актера (или еще что-нибудь). В игре существуют специальные опкоды, позволяющие "захватить" случайного прохожего и превратить его таким образом в актера. Но это тема для отдельного разговора.
Как уже говорилось, хендл суть есть обычное число. Его значение можно легко узнать, и в принципе с хендлом можно проводить любые арифметические и логические операции. Поэтому все математические опкоды, предназначенные для целых чисел действительны и для хендлов. В комментариях к ним это иногда указано:

```sb3
0084: $IntVar = $ActorHandle // integer values and handles
```

Ну и наконец заключительный тип – **строка (string)**. Он использовался во всех GTA, но только в SA получил развитие.
String представляет собой строку, т.е. набор символов. каждый из которых имеет свое численное выражение. Существует специальная таблица кодов (ASCII), в которой содержатся значения всех символов. В скриптах SA используются два вида строк: фиксированной и переменной длины. Последний вид НЕ поддерживается в GTA3 и VC.
Строки фиксированной длины **(fixed-length string)** могут содержать до 15 символов включительно. Если строка меньше этой длины, остаток заполняется пустотой. Данные строки оформляются в одинарные кавычки:

```sb3
05AA: s$MyString = 'MY_STR'
```

Обратите внимание, что для работы со строками используется специальный вид переменных. Они обозначаются буквой s: s$GlobalVar, 1@s.
Данный вид строк может использоваться и как хендл. Обратите внимание на команду

```sb3
thread 'MAIN'
```

MAIN в данном случае - это имя потока. Используя его, можно прекратить поток из любого места

```sb3
end_thread_named 'MAIN'
```

Или другой пример:

```sb3
07D3: 'HOUSE' = init_external_script_named_handle 23 (BURG_BRAINS)
```

'HOUSE' - хендл внешнего скрипта.

Строки, кроме функции хендлов, используются как идентификаторы отдельных полей в .GXT-файле.
Например:

```sb3
00BA: text_styled 'STAD_01' 1000 ms 2
```

Другой вид строк - **строки переменной длины (variable-length string)**. Они обозначаются двойными кавычками и могут содержать в себе большее по сравнению с предыдущим видом число символов. Точное число определяется самим опкодом.
Данный вид может использоваться для тех же целей, что и предыдущий. Чаще всего в оригинальных скриптах он используется для указания имен анимаций

```sb3
04ED: load_animation "LOWRIDER"
```

Переменные, содержащие такие строки, обозначаются символом v: v$GlobalVar, 1@v.

Ограничений по использованию разных видов строк нет. Это значит, что вы можете использовать в опкоде либо первый, либо второй вид, на ваше усмотрение. Однако учитывайте, что лимит на количество символов устанавливается самим опкодом. Например, вы можете использовать код:

```sb3
03A4: name_thread 'LONGNAME'
```

Однако данный опкод использует только первые 7 символов строки. Это значит, что поток после этого будет иметь имя LONGNAM, а не LONGNAMЕ, как вам хотелось.

Со строками можно проводить все основные виды операций: присваивание, сравнение, конкатенация (сложение строк).

**1. Присваивание**

```sb3
05AA: s$Var = 'IE16' // в переменную записывается строка IE16
06D1: v$Var = "NIL" // в переменную записывается строка NIL
```

Обратите внимание, справа может быть не только строка, но и стринговая переменная. Например,

```sb3
05AA: s$Var = s$Var2
```

**2. Сравнение**

```sb3
05AD: s$Var == s$Var2 
// проверка срабатывает, если содержимое переменных одинаково
08F9: v$Var == v$Var2 
// проверка срабатывает, если содержимое переменных одинаково
```

Обратите внимание, справа может быть не только стринговая переменная, но и строка. 
Например,

```sb3
08F9: v$Var == "string"
```

Проверки чувствительны к регистру, но поскольку по умолчанию все строки компилируются в верхнем регистре, данный факт будет иметь значение только при включенной опции регистра букв «Как есть».

Вы также можете проверять пустая ли строка. Для этого есть целых 4 одинаковых опкода:

```sb3
0844:   string s$Var empty
0845:   string 0@s empty
0846:   string v$Var empty
0847:   string 0@v empty
```

Все эти проверки работают абсолютно одинаково и срабатывают, если строка не содержит символов. 

**3. Сложение строк**

```sb3
098B: s$result = s$var1 + s$var2
098C: s$result = s$var1 + s$var2
```

Оба этих опкода одинаковы. Все параметры должны являться стринговыми переменными. Принцип работы таков: берется строка из переменной var1, складывается со строкой из var2 и результат записывается в переменную result.

Перечисленные выше типы данных присущи и элементам массивов. Т.е. массивы могут быть типа Integer, Float, String. Подробнее о массивах см. [здесь](../coding/arrays.md)

22.02.2007

<script src="../../js/main.min.js"></script>