<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>Панель, или  список товаров</TITLE>
<link rel="stylesheet" type="text/css" href="../../style/style.css">
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<script language="javascript" type="text/javascript" src="img/ru/clipboard.js"></script>
</HEAD>
<BODY topMargin=0 >
<TABLE
style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: #c0c0c0 1px solid"
height=121 cellSpacing=0 cellPadding=0 width=640>
  <TBODY>
  <TR>
    <TD vAlign=top width="100%"><IMG
      src="img/ru/logo2.jpg" width="640" height="121" border=0 class="conthdr" ></TD>
  </TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=640 border=0>
  <TBODY>

  <TD width="100%" height="100%" vAlign=top>
   <DIV><IMG
      src="img/ru/old/articles/articles.png" width="640" height="33"></DIV>


      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=36
            src="img/ru/mtdl.png" width=5></TD>
          <TD class=ntitle vAlign=top
          background="mtdbg.png" height=36>Панель, или  список  товаров</TD>
          <TD width=5><IMG height=36
            src="img/ru/mtdr.png"
      width=20></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5 background="ltd.gif"></TD>
          <TD class=news vAlign=top>
		  <p>При покупке одежды, оружия, экспорте транспорта нам предлагается список товаров и услуг, а также их стоимость. Выбрав один из пунктов, мы имеем возможность приобрести этот товар. Как же реализована эта возможность?<br><br>

В GTA San Andreas для этих целей применяется пара опкодов:</p>

<div class=mycode5>
<pre>08D4: <span class="general1-variable">$Panel</span> = create_panel_with_title <span class="general1-string">'IE09'</span> position <span class="general1-number">29.0 170.0</span> width <span class="general1-number">180.0</span> columns <span class="general1-number">1</span> interactive <span class="general1-number">1</span> background <span class="general1-number">1</span> alignment <span class="general1-number">0</span>
08DB: set_panel <span class="general1-variable">$Panel</span> column <span class="general1-number">0</span> header <span class="general1-string">'DUMMY'</span> data <span class="general1-string">'IE16' 'IE10' 'IE11' 'IE12' 'IE13' 'IE14' 'IE15' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY'</span></pre>
</div>
<p>
Опкодом 08D4: создаем панель с названием 'IE09'<br>
в координатах 29.0 170.0, это координаты левого верхнего угла панели<br>
ширина панели - 180.0,<br>
количество столбцов – 1<br>
interactive – 1 можно выбирать из списка, 0 – нет выбора<br>
background – 1 будет черный фон, 0 - прозрачно<br>
alignment 0  выравнивание текста, 0 - по центру , 1 - по левому краю, 2 - по правому</p>
<p>
Опкодом 08DB: устанавливаем в панели <span class="general1-variable">$Panel</span> для первого столбца название этого столбца <span class="general1-string">'DUMMY'</span> и названия строк <span class="general1-string">'IE16' 'IE10' 'IE11' 'IE12' 'IE13' 'IE14' 'IE15' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY'</span>.<br>
Максимальное количество строк в столбце – 12, если необходимо использовать только 7, как в нашем случае, то остальные неиспользуемые записываются с названием <span class="general1-string">'DUMMY'</span>.<span class="general1-string"><br>
'DUMMY'</span> – без названия. <br>
<span class="general1-string">'IE09'</span>-<span class="general1-string">'IE15'</span> – GXT текст из GXT таблицы <span class="general1-string">'MAIN'</span> <br>
Для примера, создадим панель</p>

<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard();"  ></span>
<TEXTAREA ID="holdtext" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext"><span class="general1-label">:PANEL</span>
<span class="general1-reservedword">thread</span> <span class="general1-string">'PANEL'</span>

<span class="general1-label">:PANEL_1</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span>
01B4: toggle_player <span class="general1-variable">$PLAYER_CHAR</span> can_move <span class="general1-number">0</span> <span class="general1-comment">// обездвиживаем игрока </span>
0512: show_permanent_text_box <span class="general1-string">'IE20'</span> <span class="general1-comment">//выводим text_box</span>
0581: toggle_radar <span class="general1-number">0</span> <span class="general1-comment">// убираем радар</span>
08D4: <span class="general1-variable">$PANEL</span> = create_panel_with_title <span class="general1-string">'IE09'</span> position <span class="general1-number">29.0 170.0</span> width <span class="general1-number">180.0</span> columns <span class="general1-number">1</span> interactive <span class="general1-number">1</span> background <span class="general1-number">1</span> alignment <span class="general1-number">0</span>
08DB: set_panel <span class="general1-variable">$PANEL</span> column <span class="general1-number">0</span> header <span class="general1-string">'DUMMY'</span> data <span class="general1-string">'IE16' 'IE10' 'IE11' 'IE12' 'IE13' 'IE14' 'IE15' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY'</span>

<span class="general1-label">:PANEL_3</span>
<span class="general1-reservedword">wait </span><span class="general1-number">0</span><span class="general1-reservedword">
if</span>
00E1:   player <span class="general1-number">0</span> pressed_key <span class="general1-number">15</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_3</span>
0581: toggle_radar <span class="general1-number">1</span> <span class="general1-comment">//возвращаем радар</span>
03E6: remove_text_box <span class="general1-comment">// убираем text_box</span>
08DA: remove_panel <span class="general1-variable">$PANEL</span> <span class="general1-comment">//удаляем панель</span>
01B4: toggle_player <span class="general1-variable">$PLAYER_CHAR</span> can_move <span class="general1-number">1</span> <span class="general1-comment">// возвращаем управление игроком </span>
<span class="general1-reservedword">end_thread</span></pre>
</div>
<p>Сейчас он демонстрирует только вывод панели и при нажатии на кнопку F или ENTER убираем панель. Теперь необходимо сделать возможность выбора. Нумерация строк и столбцов начинается с 0.<br>
Для того, чтобы определить, какая строка выбрана применяется опкод<br>
08D7: <span class="general1-variable">0@</span> = panel <span class="general1-variable">$Panel</span> active_row <br>
т.е. записываем в переменную <span class="general1-variable">0@</span>  номер строки.<br>
Нам необходимо определиться, что будет происходить при выборе строки.<br>
Сделаем при выборе одного из пунктов меню вывод текста. </p>

<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard1();"  ></span>
<TEXTAREA ID="holdtext1" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext1"><span class="general1-label">:PANEL</span>
<span class="general1-reservedword">thread</span> <span class="general1-string">'PANEL'</span>

<span class="general1-label">:PANEL_1</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span>
01B4: toggle_player <span class="general1-variable">$PLAYER_CHAR</span> can_move <span class="general1-number">0</span> <span class="general1-comment">// обездвиживаем игрока </span>
0512: show_permanent_text_box <span class="general1-string">'IE20'</span> <span class="general1-comment">//выводим text_box</span>
0581: toggle_radar <span class="general1-number">0</span> <span class="general1-comment">// убираем радар</span>
08D4: <span class="general1-variable">$PANEL</span> = create_panel_with_title <span class="general1-string">'IE09'</span> position <span class="general1-number">29.0 170.0</span> width <span class="general1-number">180.0</span> columns <span class="general1-number">1</span> interactive <span class="general1-number">1</span> background <span class="general1-number">1</span> alignment <span class="general1-number">0</span>
08DB: set_panel <span class="general1-variable">$PANEL</span> column <span class="general1-number">0</span> header <span class="general1-string">'DUMMY'</span> data <span class="general1-string">'IE16' 'IE10' 'IE11' 'IE12' 'IE13' 'IE14' 'IE15' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY' 'DUMMY'</span>


<span class="general1-label">:PANEL_2</span>
<span class="general1-reservedword">wait </span><span class="general1-number">0</span><span class="general1-reservedword">
if </span>
00E1: player <span class="general1-number">0</span> pressed_key <span class="general1-number">16</span> <span class="general1-comment">// если нажата клавиша «ПРОБЕЛ» </span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_9</span> <span class="general1-comment">//если нет, то переходим на метку PANEL_9</span>
08D7: <span class="general1-variable">0@</span> = panel <span class="general1-variable">$Panel</span> active_row  <span class="general1-comment">// получаем номер строки</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">0</span> <span class="general1-comment">//если выбрана первая строка</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_3</span> <span class="general1-comment">// если нет, то переходим на метку PANEL_3</span>
00BE: text_clear_all <span class="general1-comment">// убираем весь текст</span>
00BA: show_text_styled GXT <span class="general1-string">'MTG02F'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>
<span class="general1-comment">// выводим текс на экран</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@PANEL_9</span> <span class="general1-comment">// переходим на метку PANEL_9</span>

<span class="general1-label">:PANEL_3</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">1</span> <span class="general1-comment">// если выбрана вторая строка</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_4</span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME1'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@PANEL_9</span>

<span class="general1-label">:PANEL_4</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">2</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_5</span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME2'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>
jump @PANEL_9

<span class="general1-label">:PANEL_5</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">3</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_6</span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME3'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@PANEL_9</span>

<span class="general1-label">:PANEL_6</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">4</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_7</span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME4'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@PANEL_9</span>

<span class="general1-label">:PANEL_7</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">5</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_8</span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME5'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5 </span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@PANEL_9</span>

<span class="general1-label">:PANEL_8</span>
<span class="general1-reservedword">if</span>
 <span class="general1-variable">0@</span> == <span class="general1-number">6</span>  <span class="general1-comment">// если выбрана седьмая строка</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_9 </span>
00BE: text_clear_all
00BA: show_text_styled GXT <span class="general1-string">'MTIME6'</span> time <span class="general1-number">3000</span> style <span class="general1-number">5</span>

<span class="general1-label">:PANEL_9</span>
<span class="general1-reservedword">wait </span><span class="general1-number">0</span><span class="general1-reservedword">
if</span>
00E1:   player <span class="general1-number">0</span> pressed_key <span class="general1-number">15</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@PANEL_2</span> <span class="general1-comment">//если не нажата клавиша F или ENTER </span>
0581: toggle_radar <span class="general1-number">1</span> <span class="general1-comment">// возвращаем радар</span>
03E6: remove_text_box <span class="general1-comment">// убираем text_box</span>
08DA: remove_panel <span class="general1-variable">$PANEL </span><span class="general1-comment">// удаляем панель</span>
01B4: toggle_player <span class="general1-variable">$PLAYER_CHAR</span> can_move <span class="general1-number">1</span>
<span class="general1-comment">// возвращаем управление игроком </span>
<span class="general1-reservedword">end_thread</span></pre>
</div>
<p>
В этом примере панель будет на экране до тех пор, пока не будет нажата клавиша F или ENTER и если она будет нажата, то возвращаем игроку управление, и завершаем поток.</p>
<p>
Если вы дочитали это статью, то хочу с вами поделиться еще одним немаловажным требованиям к панелям, а именно:<br>
<span class="general1-string">В GTA San Andreas существует ограничение для панелей. Одновременно на экран можно выводить только две панели, если пытаться вывести больше игра вылетает.</span></p>


		  </TD>
          <TD width=5
        background="rtd.gif"></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=20
            src="img/ru/mtdlbot.png" width=5 border=0></TD>
          <TD align=left
            background="mtdbgbot.png"></TD>
          <TD class=ninfo align=right
          background="mtdbgbot.png">&nbsp;
            </TD>
          <TD width=5><IMG height=20
            src="img/ru/mtdrbot.png" width=5
        border=0></TD></TR></TBODY></TABLE></DIV>
</TD></TR><td width="100%"></TBODY></TABLE>
</TABLE></body></html>
