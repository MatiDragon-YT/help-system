<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>External Script – что это такое и как с ним работать?</TITLE>
<link rel="stylesheet" type="text/css" href="../../style/style.css">
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<script language="javascript" type="text/javascript" src="img/ru/clipboard.js"></script>
</HEAD>
<BODY topMargin=0 >
<TABLE
style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: #c0c0c0 1px solid"
height=121 cellSpacing=0 cellPadding=0 width=640>
  <TBODY>
  <TR>
    <TD vAlign=top width="100%"><IMG
      src="img/ru/logo2.jpg" width="640" height="121" border=0 class="conthdr" ></TD>
  </TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=640 border=0>
  <TBODY>

  <TD width="100%" height="100%" vAlign=top>
   <DIV><IMG
      src="img/ru/old/articles/articles.png" width="640" height="33"></DIV>


      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=36
            src="img/ru/mtdl.png" width=5></TD>
          <TD class=ntitle vAlign=top
          background="mtdbg.png" height=36><p>External Script – что это такое и как с ним работать?</p></TD>
          <TD width=5><IMG height=36
            src="img/ru/mtdr.png"
      width=20></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5 background="ltd.gif"></TD>

          <TD class=news vAlign=top><p>External Script – внешний скрипт используется только в GTA  San Andreas. Он находится отдельно от main.scm, поэтому он и называется «внешний». Внешний  скрипт является скомпилированным бинарным файлом, имеющим расширение .scm. В  отличии от main.scm  внешний скрипт не  имеет заголовка. Вся информация о нем находится в заголовке main.scm. </p>
          <div class="mycode5">DEFINE EXTERNAL_SCRIPTS <span class="general1-number">0</span> <span class="general1-comment">// Use -1 in order not to compile AAA  script<br>
            //DEFINE SCRIPT {NAME}  AT  {LABEL} @</span></div>
  <p>
            Внешние скрипты расположены в файле script.img в папке script (data/script).  Максимальное количество внешних скриптов - 82. Максимальное количество внешних  скриптов, которые могут использоваться одновременно равно 70. </p>
          <p>Внешний скрипт, как и миссия нуждается в запуске, т.е. нужен  стартер внешнего скрипта. Для примера будем использовать очищенный main.scm  (stripped.txt). Найти его можно в папке SannyBuilder\data\sa.</p>
          <p>Открываем stripped.txt в SannyBuilder’е и над комментарием</p>
          <div class="mycode5"><span class="general1-comment">{</span><br>
              <span class="general1-comment">use macro (Ctrl+J)  &quot;headsa&quot;<br>
                to insert a file  header    </span>  <br>
  <span class="general1-comment">}</span></div>
          <p>или вместо него ставим курсор и нажимаем Ctrl+J. В  появившемся списке выбираем &quot;headsa&quot; и нажимаем ENTER.   Этой незатейливой операцией мы добавили в наш файл (stripped.txt)  заголовок:</p>
          <div class="mycode5">DEFINE  MISSIONS <span class="general1-number">0</span><br>
              <span class="general1-comment">//DEFINE MISSION {ID} 0 AT {LABEL} @</span><br>
            DEFINE  EXTERNAL_SCRIPTS 0 <span class="general1-comment">// Use -1 in order not to compile AAA script</span><br>
  <span class="general1-comment">//DEFINE  SCRIPT {NAME}  AT {LABEL} @</span><br>
            DEFINE UNKNOWN_EMPTY_SEGMENT <span class="general1-number">0</span><br>
            DEFINE UNKNOWN_THREADS_MEMORY <span class="general1-number">0</span> </div>
          <p>В строке  DEFINE EXTERNAL_SCRIPTS  записывается общее количество внешних скриптов.  Изменим 0 на 1, то есть, указываем компилятору, что у нас будет добавлен 1  внешний скрипт. <br>
            Следующая строка <br>
            DEFINE  SCRIPT {NAME}  AT {LABEL} @<br>
            где NAME  – имя внешнего скрипта, назовем его, например, MILITIA и чтобы не путаться с метками  назовем ее также @MILITIA. Теперь заголовок у нас получился такой: </p>
          <div class="mycode5">DEFINE  MISSIONS <span class="general1-number">0</span><br>
              <span class="general1-comment">//DEFINE MISSION {ID} 0 AT {LABEL} @<br>
              </span><br>
            DEFINE  EXTERNAL_SCRIPTS<span class="general1-number"> 1</span> <span class="general1-comment">// Use -1 in order not to compile AAA script</span><br>
            DEFINE  SCRIPT MILITIA  AT  <span class="general1-label">@MILITIA</span>  // 0<br>
  <br>
            DEFINE  UNKNOWN_EMPTY_SEGMENT <span class="general1-number">0</span><br>
            DEFINE  UNKNOWN_THREADS_MEMORY <span class="general1-number">0 </span></div>
          <p>Теперь нам нужно добавить сам внешний скрипт. Его можно  написать самому, но в целях экономия времени воспользуемся стандартным. Это  скрипт вышибалы (External script 39 (BOUNCER)).  Я внес в него небольшие правки и переименовал  в MILITIA.  Добавим его в наш файл после  строки <br>
              <span class="general1-comment">// put your  external scripts here.</span><br>
            Сохраняем файл, компилируем и запускаем игру.  </p>
          <p>Ну что же половина дела сделано, осталось заставить его  работать.</p>
          <p>Тут нам понадобится стартер внешнего скрипта. Есть разные  варианты запуска внешних скриптов. Рассмотрим усе. :)</p>
          <p>Для начала нужно сказать, что существует возможность  привязать внешний скрипт к нужному вам объекту. Делается это опкодом:<br>
            0929:  init_external_script_trigger <span class="general1-number">7</span> (ARCADE) with_object_model <span class="general1-model">#CJ_COIN_OP_3</span> priority <span class="general1-number">100</span> radius <span class="general1-number">4.0</span> type <span class="general1-number">-1</span><br>
            привязываем к объекту <span class="general1-model">#CJ_COIN_OP_3</span> (игровой автомат space  monkey) внешний скрипт видео игры.<br>
            Или <br>
            0929:  init_external_script_trigger <span class="general1-number">10</span> (GATES_SCRIPT) with_object_model <span class="general1-model">#GATE_AUTOL</span> priority <span class="general1-number">100</span> radius <span class="general1-number">80.0</span> type <span class="general1-number">-1</span><br>
            тут, соответственно, к объекту <span class="general1-model">#GATE_AUTOL</span> (решётка левая) привязываем внешний скрипт открытия Ворот  Аэропорта.</p>
          <p>Так же можно привязать внешний скрипт к интерьеру:<br>
            07D3: <span class="general1-string">'HOUSE'</span> = init_external_script_named_handle <span class="general1-number">23</span> (BURG_BRAINS)<br>
            или объявить название внешнего скрипта<br>
            0884: <span class="general1-string">'DANCER'</span> = init_external_script_named_handle <span class="general1-number">52</span> (DANCER)<br>
            замечу, что принцип работы опкодов 07D3 и 0884 мне не известен, а так же не  понятно работают они или нет.</p>
          <p>Можно привязать внешний скрипт к модели актера <br>
            0928:  init_external_script_trigger <span class="general1-number">19</span> (DEALER) with_actor_model <span class="general1-model">#BMYDRUG</span> priority <span class="general1-number">100</span><br>
            В оригинальном майне этот опкод идет в паре с<br>
            08E8:  assign_external_script_handle <span class="general1-string">'DEALER'</span> to_model <span class="general1-model">#BMYDRUG</span></p>
          <p>мне кажется, что опкод 08E8 привязывает модель актера <span class="general1-model">#BMYDRUG</span>  к потоку с именем (названием) <span class="general1-string">' DEALER '</span> ( 03A4: name_thread <span class="general1-string">' DEALER '</span>).</p>
          <p>Ну что же для начала воспользуемся опкодом 0928.<br>
            Еще раз запустим игру. Подходим к барышне в светлой кепке и  темной футболке с номером 31. Наносим ей удар в челюсть (хук справа :) ) и  наблюдаем ее реакцию. </p>
          <p>Теперь добавим к нашему майну в поток <span class="general1-string">'MAIN'</span>  над строкой end_thread  такую запись:<br>
            0928:  init_external_script_trigger <span class="general1-number">0</span> (MILITIA) with_actor_model <span class="general1-model">#BFYST</span> priority <span class="general1-number">100 </span><br>
            08E8:  assign_external_script_handle <span class="general1-string">'MILITIA'</span> to_model <span class="general1-model">#BFYST </span> <br>
            компилируем и запускаем игру. <br>
            Подходим к барышне в светлой кепке и темной футболке с  номером 31. Наносим ей удар в челюсть (хук справа :) ) и наблюдаем ее реакцию.  Заметили, что ее реакция изменилась. Итак, наш внешний скрипт запущен и  работает. Убедится в этом можно также и по наличию у данной барышни оружия (model <span class="general1-model">#COLT45</span>). Но стоит получить оду звезду розыска, как барышня будет атаковать  игрока. А если игрок начнет стрелять (при наличии звез), то барышня будет  атаковать игрока с применением оружия. <br>
            Немного поясню принцип работы опкода 0928.<br>
            Игра генерирует случайных актеров, опкодом 0928 мы указываем  игре привязать к модели актера <span class="general1-model">#BFYST</span>  наш внешний скрипт. Теперь при каждом  создании случайного актера с моделью<span class="general1-model"> #BFYST </span> игра применит к этому актеру внешний скрипт.   <br>
            При таком запуске внешний скрипт будет  работать всегда, вне зависимости от того на миссии игрок или нет. Для нашего  случая это не смертельно, поскольку он у нас один. Но для оригинального майна  существует лимит количества одновременно запущенных внешних скриптов, и  превышать его не рекомендуется. <a href="examples/external_script[0].txt" target="_blank">Смотрите пример</a></p>
          <p>Теперь пришло время рассмотреть вариант запуска внешнего  скрипта при выполнении условия (условий). Для этого напишем стартер внешнего  скрипта: </p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard();"  ></span>
<TEXTAREA ID="holdtext" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext" class="NON"><span class="general1-label">:STARTEX</span>
03A4: name_thread <span class="general1-string">'STARTEX' </span>
00D6: <span class="general1-reservedword">if  and</span>
0038: <span class="general1-variable">$ONMISSION </span>== <span class="general1-number">0</span> <span class="general1-comment">// не на  миссии </span>
0256: player <span class="general1-variable">$PLAYER_CHAR</span> defined 
004D:  jump_if_false <span class="general1-label">@STARTEX_120</span>
0226: <span class="general1-variable">0@</span> =  actor <span class="general1-variable">$PLAYER_ACTOR</span> health
00D6: <span class="general1-reservedword">if</span>
8039: <span class="general1-reservedword">not</span>  <span class="general1-variable">0@</span> == <span class="general1-number">0</span>
<span class="general1-comment">// если здоровье игрока равно 0 то идем на метку завершения  внешнего скрипта</span>
004D:  jump_if_false <span class="general1-label">@STARTEX_131 </span>
0926: <span class="general1-variable">$Script_Status</span> = external_script_status <span class="general1-number">0</span> (MILITIA)
<span class="general1-comment">//определяем запущен внешний  скрипт или нет</span>
00D6: <span class="general1-reservedword">if </span>
0038: <span class="general1-variable">$Script_Status</span> == <span class="general1-number">0</span<span class="general1-comment">// при 0 запускаем внешний скрипт </span>
004D: jump_if_false <span class="general1-label">@STARTEX_120</span>
<span class="general1-comment">// если $Script_Status = 1,
// то соответственно  второй раз запускать скрипт не нужно</span>
08A9:  load_external_script <span class="general1-number">0</span> (MILITIA)  <span class="general1-comment">// загружаем внешний скрипт </span>
00D6: <span class="general1-reservedword">if </span>
08AB: external_script <span class="general1-number">0</span> (MILITIA) loaded<span class="general1-comment"> //проверяем загружен ли скрипт </span>
004D:  jump_if_false <span class="general1-label">@STARTEX_120</span>
0913:  run_external_script <span class="general1-number">0</span> (MILITIA)  <span class="general1-comment">// запускаем внешний скрипт </span>

<span class="general1-label">:STARTEX_120</span>
0001: <span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0002: <span class="general1-reservedword">jump</span> <span class="general1-label">@STARTEX </span>

<span class="general1-label">:STARTEX_131</span>
090F:  end_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-comment">// останавливаем работу скрипта </span>
0001: <span class="general1-reservedword">wait </span>0 ms
0002: <span class="general1-reservedword">jump</span> <span class="general1-label">@STARTEX  </span></pre></div>
          <p>ну что же стартер внешнего скрипта работает, но он не  подходит нам, поскольку в нашем скрипте нет создания актера, а стало быть, наш  внешний скрипт не работает полностью. <a href="examples/external_script[1].txt" target="_blank">Смотрите пример</a></p>
          <p>Добавим  в стартер  создание актера актера</p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard1();"  ></span>
<TEXTAREA ID="holdtext1" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext1" class="NON"><span class="general1-label">:STARTEX</span>
03A4: name_thread <span class="general1-string">'STARTEX' </span>
00D6: <span class="general1-reservedword">if  and</span>
0038: <span class="general1-variable">$ONMISSION</span> == <span class="general1-number">0 </span>
0256: player <span class="general1-variable">$PLAYER_CHAR</span> defined
004D: jump_if_false <span class="general1-label">@STARTEX_120 </span>
0226: <span class="general1-variable">0@</span> =  actor <span class="general1-variable">$PLAYER_ACTOR</span> health
00D6: <span class="general1-reservedword">if</span>
8039: <span class="general1-reservedword">not</span>  <span class="general1-variable">0@</span> == <span class="general1-number">0 </span>
004D: jump_if_false <span class="general1-label">@STARTEX_131</span>
0926: <span class="general1-variable">$Script_Status</span> = external_script_status <span class="general1-number">0</span> (MILITIA)
00D6: <span class="general1-reservedword">if </span>
0038: <span class="general1-variable">$Script_Status</span> == <span class="general1-number">0 </span>
004D: jump_if_false <span class="general1-label">@STARTEX_120 </span>
08A9: load_external_script <span class="general1-number">0</span> (MILITIA)
00D6: <span class="general1-reservedword">if </span>
08AB: external_script <span class="general1-number">0</span> (MILITIA) loaded
004D: jump_if_false <span class="general1-label">@STARTEX_120 </span>
04C4: store_coords_to <span class="general1-variable">2@ 3@ 4@</span> from_actor <span class="general1-variable">$PLAYER_ACTOR</span> with_offset <span class="general1-number">1.0 3.0 -0.9 </span>
009A: <span class="general1-variable">1@</span> =  create_actor_pedtype<span class="general1-number"> 4 </span> model <span class="general1-model">#MALE01</span> at <span class="general1-variable">2@ 3@ 4@</span> 
0913: run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-variable">1@</span>

<span class="general1-label">:STARTEX_120</span>
0001: <span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0002:<span class="general1-reservedword"> jump</span> <span class="general1-label">@STARTEX </span>

<span class="general1-label">:STARTEX_131</span>
090F: end_external_script <span class="general1-number">0</span> (MILITIA)
0002:<span class="general1-reservedword"> jump</span> <span class="general1-label">@STARTEX</span></pre>
</div>
          <p>Опкодом 04C4:  - записываем в переменные <span class="general1-variable">2@ 3@ 4@</span> координаты  относительно актера <span class="general1-variable">$PLAYER_ACTOR</span> со  смещением <span class="general1-number">1.0 3.0 -0.9</span>.<br>
            Опкодом  009A: - создаем актера с в  координатах <span class="general1-variable">2@ 3@ 4@</span>,  <br>
            модели <span class="general1-model">#MALE01</span> и <span class="general1-model">#NULL</span> не требуют предварительной загрузки.<br>
            0913: run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-variable">1@</span> - запускаем внешний скрипт с  созданным нами актером. Это запуск внешнего скрипта с параметрами. <a href="examples/external_script[2].txt" target="_blank">Смотрите пример</a></p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard2();"  ></span>
<TEXTAREA ID="holdtext2" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext2"><span class="general1-label">:STARTEX</span>
03A4: name_thread<span class="general1-string"> 'STARTEX' </span>
00D6: <span class="general1-reservedword">if  and</span>
0038: <span class="general1-variable">$ONMISSION</span> == <span class="general1-number">0</span>
0256: player <span class="general1-variable">$PLAYER_CHAR</span> defined
004D: jump_if_false <span class="general1-label">@STARTEX_159 </span>
0226: <span class="general1-variable">0@</span> =  actor <span class="general1-variable">$PLAYER_ACTOR</span> health
00D6: <span class="general1-reservedword">if</span>
8039: <span class="general1-reservedword">not</span>  <span class="general1-variable">0@</span> == <span class="general1-number">0</span>
004D: jump_if_false <span class="general1-label">@STARTEX_170 </span>
0926: <span class="general1-variable">$Script_Status</span> = external_script_status <span class="general1-number">0</span> (MILITIA)
00D6: <span class="general1-reservedword">if </span>
0038:  <span class="general1-variable">$Script_Status </span>== <span class="general1-number">0 </span>
004D: jump_if_false <span class="general1-label">@STARTEX_159 </span>
08A9: load_external_script 0 (MILITIA)
00D6: <span class="general1-reservedword">if </span>
08AB: external_script <span class="general1-number">0</span> (MILITIA) loaded
004D: jump_if_false <span class="general1-label">@STARTEX_159 </span>
0615: define_AS_pack_begin <span class="general1-variable">5@ </span>
05DE: AS_actor <span class="general1-number">-1</span> walk_around_ped_path
0616: define_AS_pack_end <span class="general1-variable">5@ </span>
04C4: store_coords_to <span class="general1-variable">2@ 3@ 4@</span> from_actor <span class="general1-variable">$PLAYER_ACTOR</span> with_offset <span class="general1-number">1.0 3.0 -0.9</span>
04C4: store_coords_to <span class="general1-variable">7@ 8@ 9@ </span>from_actor <span class="general1-variable">$PLAYER_ACTOR</span> with_offset <span class="general1-number">1.0 -3.0 -0.9</span>
061D: create_AS_origin_at <span class="general1-variable">7@ 8@ 9@</span> Z_angle <span class="general1-number">60.0</span> unknown_angle <span class="general1-number">300.0</span> AS_pack <span class="general1-variable">5@ </span>handle_as <span class="general1-variable">6@</span>
0621: create_actor_pedtype <span class="general1-number">6</span> model <span class="general1-model">#NULL</span> at_AS_origin <span class="general1-variable">6@</span> task <span class="general1-number">1502</span> handle_as <span class="general1-variable">10@</span>
009A: <span class="general1-variable">1@</span> =  create_actor_pedtype <span class="general1-number">6</span> model <span class="general1-model">#MALE01</span> at <span class="general1-variable">2@ 3@ 4@</span>
0913: run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-variable">1@</span>
0913: run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-variable">10@</span>  

<span class="general1-label">:STARTEX_159</span>
0001: <span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0002: <span class="general1-reservedword">jump</span> <span class="general1-label">@STARTEX </span>

<span class="general1-label">:STARTEX_170</span>
090F: end_external_script <span class="general1-number">0</span> (MILITIA)
0001: <span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0002:<span class="general1-reservedword"> jump</span> <span class="general1-label">@STARTEX</span></pre>
</div>
          <p>Вот Вам второй вариант. Опкодом 061D: - записываем в переменную <span class="general1-variable">6@</span> последовательность <span class="general1-variable">5@</span> действий в точке <span class="general1-variable">7@ 8@ 9@</span>. Опкодом  0621: - в переменную <span class="general1-variable">10@</span> записываем  создание актера с типом <span class="general1-number">6</span> (полицейский),  моделью <span class="general1-model">#NULL</span> с  последовательностью действий <span class="general1-variable">6@</span> <br> <a href="examples/external_script[3].txt" target="_blank">Смотрите пример</a></p>
          <p>Теперь рассмотрим запуск внешнего скрипта с различными  параметрами.<br>
            Например для запуска GF_MEETING  используется такая запись <br>
            0913:  run_external_script <span class="general1-number">24</span> (GF_MEETING) <span class="general1-variable">$Girlfriend 10@ 11@ 12@ 13@</span><br>
            где соответственно: <br>
  <span class="general1-variable">$Girlfriend </span>– актер <br>
  <span class="general1-variable">10@</span> - X<br>
  <span class="general1-variable">11@</span> - Y<br>
  <span class="general1-variable">12@</span> - Z<br>
  <span class="general1-variable">13@</span> - угол<br>
            а для запуска GF_SEX:<br>
            0913:  run_external_script <span class="general1-number">26</span> (GF_SEX) <span class="general1-variable">$Girlfriend</span> <span class="general1-number">1</span> <span class="general1-variable">3@ 10@ 11@ 12@ 13@</span><br>
  <span class="general1-variable">10@, 11@, 12@, 13@</span> - X, Y, Z, угол <br>
  <span class="general1-variable">3@ </span>-  интерьер<br>
  <span class="general1-number">1</span> –  пока не совсем понятно<br>
            или такой <br>
            0913:  run_external_script <span class="general1-number">26</span> (GF_SEX) <span class="general1-variable">40@ 41@</span> <span class="general1-number">0 2037.651 2723.871 9.8352 0.0702</span></p>
          <p>Я долго не мог понять почему для разных скриптов порядок  передачи параметров разный. В одних переменная актера стоит первой<br>
            0913: run_external_script <span class="general1-number">26</span> (GF_SEX)<span class="general1-variable"> $Girlfriend </span><span class="general1-number">1</span> <span class="general1-variable">3@ 10@ 11@ 12@ 13@</span><br>
            а в других, переменная актера может быть в любом другом  месте<br>
            0913: run_external_script <span class="general1-number">1</span> (PARACHUTE) <span class="general1-number">-1 -10.0 10.0 -5.0  -2.0 10.0 12.0 1</span> <span class="general1-variable">70@</span><br>
            где <br>
  <span class="general1-variable">70@</span> - переменная актера.<br>
            Теперь могу сказать, что очередность параметров определяется  во внешнем скрипте,<br>
            (СПАСИБО <strong>Seemann</strong><strong>’</strong><strong>у за помощь</strong><strong> :)</strong>) <br>
            Рассмотрим пример передачи параметров<br>
            Для этого напишем простейший внешний скрипт</p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard3();"  ></span>
<TEXTAREA ID="holdtext3" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext3" class="NON"><span class="general1-label">:MILITIA</span>
03A4:  name_thread <span class="general1-string">'MILITIA' </span>

<span class="general1-label">:MILITIA_1 </span>
009A: <span class="general1-variable">4@</span> =  create_actor_pedtype <span class="general1-number">4</span> model <span class="general1-variable">0@</span> at <span class="general1-variable">1@ 2@ 3@</span>

<span class="general1-label">:MILITIA_2</span>
<span class="general1-reservedword">wait </span><span class="general1-number">0</span><span class="general1-reservedword">
if</span>
 8118: not  actor <span class="general1-variable">4@</span> dead
<span class="general1-reservedword">jf</span> <span class="general1-variable">@MILITIA_717</span>
062E:  unknown_get_actor <span class="general1-variable">4@</span> task <span class="general1-number">1506</span> status_store_to <span class="general1-variable">5@</span> <span class="general1-comment">// ret 7 if not found </span>
00D6: <span class="general1-reservedword">if </span>
04A4: <span class="general1-variable">5@</span> == <span class="general1-number">7</span> <span class="general1-comment">// @ == any </span>
004D:  jump_if_false <span class="general1-label">@MILITIA_2</span>
05E2:  AS_actor <span class="general1-variable">4@ </span>kill_actor <span class="general1-variable">$PLAYER_ACTOR  </span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@MILITIA_2</span>

<span class="general1-label">:MILITIA_717</span>
01C2:  remove_references_to_actor <span class="general1-variable">4@</span>
004E: <span class="general1-reservedword">end_thread</span></pre></div>
          <p>и стартер внешнего скрипта</p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard4();"  ></span>
<TEXTAREA ID="holdtext4" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext4" class="NON"><span class="general1-label">:STARTEX</span>
03A4:  name_thread <span class="general1-string">'STARTEX' </span>
00D6: <span class="general1-reservedword">if  and</span>
0038: <span class="general1-variable">$ONMISSION</span> == <span class="general1-number">0 </span>
0256: player <span class="general1-variable">$PLAYER_CHAR</span> defined
004D: jump_if_false<span class="general1-label"> @STARTEX_159</span>
0226: <span class="general1-variable">10@</span> =  actor <span class="general1-variable">$PLAYER_ACTOR</span> health
00D6: <span class="general1-reservedword">if </span>
8039: <span class="general1-reservedword">not </span> <span class="general1-variable">10@</span> == <span class="general1-number">0 </span>
004D: jump_if_false <span class="general1-label">@STARTEX_170 </span>
0926: <span class="general1-variable">$Script_Status</span> = external_script_status <span class="general1-number">0</span> (MILITIA)
00D6: <span class="general1-reservedword">if </span>
0038: <span class="general1-variable">$Script_Status</span> == <span class="general1-number">0 </span>
004D: jump_if_false <span class="general1-label">@STARTEX_159 </span>
08A9: load_external_script <span class="general1-number">0</span> (MILITIA)
00D6: <span class="general1-reservedword">if </span>
08AB: external_script <span class="general1-number">0 </span>(MILITIA) loaded
004D: jump_if_false <span class="general1-label">@STARTEX_159 </span>
04C4: store_coords_to <span class="general1-variable">1@ 2@ 3@</span> from_actor <span class="general1-variable">$PLAYER_ACTOR</span> with_offset <span class="general1-number">1.0 3.0 -0.9</span>
0913: run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-model">#MALE01</span> <span class="general1-number">2482.72 -1658.6648 13.3372</span>

<span class="general1-label">:STARTEX_159</span>
0001: <span class="general1-reservedword">wait </span><span class="general1-number">250</span> ms
0002: <span class="general1-reservedword">jump</span> <span class="general1-label">@STARTEX </span>

<span class="general1-label">:STARTEX_170</span>
090F: end_external_script <span class="general1-number">0</span> (MILITIA)
0001: <span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0002: <span class="general1-reservedword">jump</span> <span class="general1-label">@STARTEX</span></pre>
</div>
          <p>Очередность передачи зависит от очередности локальных  переменных во внешнем скрипте.<br>
            Мы запускаем внешний скрипт с параметрами<br>
            0913:  run_external_script <span class="general1-number">0</span> (MILITIA) <span class="general1-model">#MALE01</span> <span class="general1-number">2482.72 -1658.6648 13.3372</span> <br>
            где<br>
  <span class="general1-model">#MALE01</span> передается переменной <span class="general1-variable">0@</span> во внешнем скрипте,<br>
  <span class="general1-number">2482.72</span> - <span class="general1-variable">1@</span><br>
  <span class="general1-number">-1658.6648</span> - <span class="general1-variable">2@</span><br>
  <span class="general1-number">13.3372</span> - <span class="general1-variable">3@</span></p>
          <div class="mycode5"><span class="general1-label">:MILITIA_1 </span><br>
            009A: <span class="general1-variable">4@</span> =  create_actor_pedtype <span class="general1-number">4</span> model <span class="general1-variable">0@ </span>at <span class="general1-variable">1@ 2@ 3@</span> </div>
          <p><a href="examples/external_script[4].txt" target="_blank">Смотрите пример</a></p>
          <p>Таким образом передавать можно до 34 параметров. 32  локальных переменных (<span class="general1-variable">0@</span> …<span class="general1-variable">31@</span>) + 2 таймера (<span class="general1-variable">32@</span>,<span class="general1-variable">33@</span>).</p>
          <p>Оригинальная игра в настоящий момент имеет 78 внешних скриптов. <br>
            Список внешних скриптов взят с <a href="http://www.gtamodding.com" target="_blank">http://www.gtamodding.com</a> </p>
          <TABLE align="center" class="text8">
            <TBODY>
              <TR>
                <TH width="58">Number </TH>
                <TH width="153">Name </TH>
                <TH width="327">Description </TH>
              </TR>
              <TR>
                <TD class="kays2">0 </TD>
                <TD class="var">PLAYER_PARACHUTE </TD>
                <TD>Controls the player's parachute </TD>
              </TR>
              <TR>
                <TD class="kays2">1 </TD>
                <TD class="var">PARACHUTE </TD>
                <TD>Controls the AI's parachute </TD>
              </TR>
              <TR>
                <TD class="kays2">2 </TD>
                <TD class="var">BCESAR2 </TD>
                <TD>Smoke's money from Los Santos to San Fierro </TD>
              </TR>
              <TR>
                <TD class="kays2">3 </TD>
                <TD class="var">BCESAR3 </TD>
                <TD>Smoke's yay from San Fierro to Los Santos </TD>
              </TR>
              <TR>
                <TD class="kays2">4 </TD>
                <TD class="var">SLOT_MACHINE </TD>
                <TD>Slot machine </TD>
              </TR>
              <TR>
                <TD class="kays2">5 </TD>
                <TD class="var">ROULETTE </TD>
                <TD>Roulette </TD>
              </TR>
              <TR>
                <TD class="kays2">6 </TD>
                <TD class="var">OTB_SCRIPT </TD>
                <TD>Off track betting machine </TD>
              </TR>
              <TR>
                <TD class="kays2">7 </TD>
                <TD class="var">ARCADE </TD>
                <TD>Arcade game mission checker (not the game itself) </TD>
              </TR>
              <TR>
                <TD class="kays2">8 </TD>
                <TD class="var">VENDING_MACHINE </TD>
                <TD>Vending machines (both food and drinks) </TD>
              </TR>
              <TR>
                <TD class="kays2">9 </TD>
                <TD class="var">FOOD_VENDOR </TD>
                <TD>Food vendors </TD>
              </TR>
              <TR>
                <TD class="kays2">10 </TD>
                <TD class="var">GATES_SCRIPT </TD>
                <TD>Airport gates </TD>
              </TR>
              <TR>
                <TD class="kays2">11 </TD>
                <TD class="var">GYMBIKE </TD>
                <TD>Bike </TD>
              </TR>
              <TR>
                <TD class="kays2">12 </TD>
                <TD class="var">GYMBENCH </TD>
                <TD>Bench </TD>
              </TR>
              <TR>
                <TD class="kays2">13 </TD>
                <TD class="var">GYMTREAD </TD>
                <TD>Treadmill </TD>
              </TR>
              <TR>
                <TD class="kays2">14 </TD>
                <TD class="var">GYMDUMB </TD>
                <TD>Dumbell </TD>
              </TR>
              <TR>
                <TD class="kays2">15 </TD>
                <TD class="var">BASKETB </TD>
                <TD>Basketball </TD>
              </TR>
              <TR>
                <TD class="kays2">16 </TD>
                <TD class="var">VIDPOK </TD>
                <TD>Video poker machine </TD>
              </TR>
              <TR>
                <TD class="kays2">17 </TD>
                <TD class="var">BLACKJ </TD>
                <TD>Blackjack </TD>
              </TR>
              <TR>
                <TD class="kays2">18 </TD>
                <TD class="var">WHEELO </TD>
                <TD>Wheel of Fortune </TD>
              </TR>
              <TR>
                <TD class="kays2">19 </TD>
                <TD class="var">DEALER </TD>
                <TD>Drug dealer </TD>
              </TR>
              <TR>
                <TD class="kays2">20 </TD>
                <TD class="var">HOME_BRAINS </TD>
                <TD>Hobo's AI </TD>
              </TR>
              <TR>
                <TD class="kays2">21 </TD>
                <TD class="var">POOL_SCRIPT </TD>
                <TD>Pool </TD>
              </TR>
              <TR>
                <TD class="kays2">22 </TD>
                <TD class="var">LOWR_CONT </TD>
                <TD>Lowrider contest </TD>
              </TR>
              <TR>
                <TD class="kays2">23 </TD>
                <TD class="var">BURG_BRAINS </TD>
                <TD>Burgulary's ped AI </TD>
              </TR>
              <TR>
                <TD class="kays2">24 </TD>
                <TD class="var">GF_MEETING </TD>
                <TD>Girlfriend meeting </TD>
              </TR>
              <TR>
                <TD class="kays2">25 </TD>
                <TD class="var">GF_DATE </TD>
                <TD>Girlfriend date </TD>
              </TR>
              <TR>
                <TD class="kays2">26 </TD>
                <TD class="var">GF_SEX </TD>
                <TD>Girlfriend sex </TD>
              </TR>
              <TR>
                <TD class="kays2">27 </TD>
                <TD class="var">CASINO_AMBIENCE </TD>
                <TD>Casino ambience </TD>
              </TR>
              <TR>
                <TD class="kays2">28 </TD>
                <TD class="var">BAR_AMBIENCE </TD>
                <TD>Bar ambience </TD>
              </TR>
              <TR>
                <TD class="kays2">29 </TD>
                <TD class="var">FOODBRAINS </TD>
                <TD>Restaurant's ped AI </TD>
              </TR>
              <TR>
                <TD class="kays2">30 </TD>
                <TD class="var">OTB_AMBIENCE </TD>
                <TD>Off track betting ambience </TD>
              </TR>
              <TR>
                <TD class="kays2">31 </TD>
                <TD class="var">STRIP_AMBIENCE </TD>
                <TD>Strip club ambience </TD>
              </TR>
              <TR>
                <TD class="kays2">32 </TD>
                <TD class="var">PLANES </TD>
                <TD>Airline traveling </TD>
              </TR>
              <TR>
                <TD class="kays2">33 </TD>
                <TD class="var">TRAINS </TD>
                <TD>Being a passenger in the train </TD>
              </TR>
              <TR>
                <TD class="kays2">34 </TD>
                <TD class="var">ZERO_AMBIENCE </TD>
                <TD>Zero's RC Shop ambience </TD>
              </TR>
              <TR>
                <TD class="kays2">35 </TD>
                <TD class="var">DANCE </TD>
                <TD>DDR </TD>
              </TR>
              <TR>
                <TD class="kays2">36 </TD>
                <TD class="var">SHOPKEEPER </TD>
                <TD>Restuarant shopkeeper AI </TD>
              </TR>
              <TR>
                <TD class="kays2">37 </TD>
                <TD class="var">CUSTOMER_PANIC </TD>
                <TD>Ped's panic AI </TD>
              </TR>
              <TR>
                <TD class="kays2">38 </TD>
                <TD class="var">BAR_STAFF </TD>
                <TD>Bartender AI </TD>
              </TR>
              <TR>
                <TD class="kays2">39 </TD>
                <TD class="var">BOUNCER </TD>
                <TD>Bouncer AI </TD>
              </TR>
              <TR>
                <TD class="kays2">40 </TD>
                <TD class="var">OTB_STAFF </TD>
                <TD>OTB staff AI </TD>
              </TR>
              <TR>
                <TD class="kays2">41 </TD>
                <TD class="var">PCHAIR </TD>
                <TD>Restaurant ped in chair AI </TD>
              </TR>
              <TR>
                <TD class="kays2">42 </TD>
                <TD class="var">PCUSTOM </TD>
                <TD>Restaurant ped not in chair AI </TD>
              </TR>
              <TR>
                <TD class="kays2">43 </TD>
                <TD class="var">OTBWTCH </TD>
                <TD>OTB ped AI </TD>
              </TR>
              <TR>
                <TD class="kays2">44 </TD>
                <TD class="var">OTBSLP </TD>
                <TD>Ped betting OTB AI </TD>
              </TR>
              <TR>
                <TD class="kays2">45 </TD>
                <TD class="var">OTBTILL </TD>
                <TD>Ped walking around OTB AI </TD>
              </TR>
              <TR>
                <TD class="kays2">46 </TD>
                <TD class="var">FBOOTHR </TD>
                <TD>Ped eating food AI </TD>
              </TR>
              <TR>
                <TD class="kays2">47 </TD>
                <TD class="var">FBOOTHL </TD>
                <TD>Ped eating food AI </TD>
              </TR>
              <TR>
                <TD class="kays2">48 </TD>
                <TD class="var">BARGUY </TD>
                <TD>Barman AI </TD>
              </TR>
              <TR>
                <TD class="kays2">49 </TD>
                <TD class="var">PEDROUL </TD>
                <TD>Roulette gamer AI </TD>
              </TR>
              <TR>
                <TD class="kays2">50 </TD>
                <TD class="var">PEDCARD </TD>
                <TD>Card gamer AI </TD>
              </TR>
              <TR>
                <TD class="kays2">51 </TD>
                <TD class="var">PEDSLOT </TD>
                <TD>Slot-machine gamer AI </TD>
              </TR>
              <TR>
                <TD class="kays2">52 </TD>
                <TD class="var">DANCER </TD>
                <TD>Club dancer AI </TD>
              </TR>
              <TR>
                <TD class="kays2">53 </TD>
                <TD class="var">STRIPW </TD>
                <TD>Strip dancing female </TD>
              </TR>
              <TR>
                <TD class="kays2">54 </TD>
                <TD class="var">STRIPM </TD>
                <TD>Strip dancing male </TD>
              </TR>
              <TR>
                <TD class="kays2">55 </TD>
                <TD class="var">BROWSE </TD>
                <TD>Inside police HQ cop browsing folder or locker </TD>
              </TR>
              <TR>
                <TD class="kays2">56 </TD>
                <TD class="var">COPSIT </TD>
                <TD>Inside police HQ cop sitting </TD>
              </TR>
              <TR>
                <TD class="kays2">57 </TD>
                <TD class="var">COPLOOK </TD>
                <TD>Inside police HQ cop looking at posters </TD>
              </TR>
              <TR>
                <TD class="kays2">58 </TD>
                <TD class="var">TICKET </TD>
                <TD>Train ticket machine AI </TD>
              </TR>
              <TR>
                <TD class="kays2">59 </TD>
                <TD class="var">SHOPPER </TD>
                <TD>Ped Binco AI </TD>
              </TR>
              <TR>
                <TD class="kays2">60 </TD>
                <TD class="var">AMMU </TD>
                <TD>Ammunation </TD>
              </TR>
              <TR>
                <TD class="kays2">61 </TD>
                <TD class="var">TATTOO </TD>
                <TD>Tatto </TD>
              </TR>
              <TR>
                <TD class="kays2">62 </TD>
                <TD class="var">BARBER </TD>
                <TD>Barber </TD>
              </TR>
              <TR>
                <TD class="kays2">63 </TD>
                <TD class="var">WARDROBE </TD>
                <TD>Player's wardrobe </TD>
              </TR>
              <TR>
                <TD class="kays2">64 </TD>
                <TD class="var">CLOTHES </TD>
                <TD>Clothes </TD>
              </TR>
              <TR>
                <TD class="kays2">65 </TD>
                <TD class="var">JUNKFUD </TD>
                <TD>Food selection </TD>
              </TR>
              <TR>
                <TD class="kays2">66 </TD>
                <TD class="var">CARMOD1 </TD>
                <TD>Mod garage </TD>
              </TR>
              <TR>
                <TD class="kays2">67 </TD>
                <TD class="var">CRANE1 </TD>
                <TD>San Fierro and Las Venturas construction site cranes </TD>
              </TR>
              <TR>
                <TD class="kays2">68 </TD>
                <TD class="var">CRANE2 </TD>
                <TD>IE ship crane </TD>
              </TR>
              <TR>
                <TD class="kays2">69 </TD>
                <TD class="var">CRANE3 </TD>
                <TD>Quarry crane </TD>
              </TR>
              <TR>
                <TD class="kays2">70 </TD>
                <TD class="var">CARPARK1 </TD>
                <TD>Random car for carpark generators </TD>
              </TR>
              <TR>
                <TD class="kays2">71 </TD>
                <TD class="var">IMPOUND </TD>
                <TD>Impound lots </TD>
              </TR>
              <TR>
                <TD class="kays2">72 </TD>
                <TD class="var">VALET </TD>
                <TD>Valet </TD>
              </TR>
              <TR>
                <TD class="kays2">73 </TD>
                <TD class="var">PHOTO </TD>
                <TD>Suicide photographer </TD>
              </TR>
              <TR>
                <TD class="kays2">74 </TD>
                <TD class="var">PRISONR </TD>
                <TD>Prisoner AI </TD>
              </TR>
              <TR>
                <TD class="kays2">75 </TD>
                <TD class="var">CAMERA </TD>
                <TD>Homie's camera holding AI </TD>
              </TR>
              <TR>
                <TD class="kays2">76 </TD>
                <TD class="var">DEBT </TD>
                <TD>Casino debt </TD>
              </TR>
              <TR>
                <TD class="kays2">77 </TD>
                <TD class="var">HOTDOG </TD>
                <TD>Hotdog van </TD>
              </TR>
            </TBODY>
          </TABLE>
          <p class="legal">Список внешних скриптов by spaceeinstein </p>

          </TD>
          <TD width=5
        background="rtd.gif"></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=20
            src="img/ru/mtdlbot.png" width=5 border=0></TD>
          <TD align=left
            background="mtdbgbot.png"></TD>
          <TD class=ninfo align=right
          background="mtdbgbot.png">&nbsp;
            </TD>
          <TD width=5><IMG height=20
            src="img/ru/mtdrbot.png" width=5
        border=0></TD></TR></TBODY></TABLE></DIV>
<BR><BR></TD></TR><td width="100%"></TBODY></TABLE>
</TABLE></body></html>
