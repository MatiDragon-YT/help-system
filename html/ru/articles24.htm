<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>Контроль клавиатуры </TITLE>
<link rel="stylesheet" type="text/css" href="../../style/style.css">
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<script language="javascript" type="text/javascript" src="img/ru/clipboard.js"></script>
</HEAD>
<BODY topMargin=0 >
<TABLE
style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: #c0c0c0 1px solid"
height=121 cellSpacing=0 cellPadding=0 width=640>
  <TBODY>
  <TR>
    <TD vAlign=top width="100%"><IMG
      src="img/ru/logo2.jpg" width="640" height="121" border=0 class="conthdr" ></TD>
</TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=640 border=0>
  <TBODY>

  <TD width="100%" height="100%" vAlign=top>
   <DIV><IMG
      src="img/ru/old/articles/articles.png" width="640" height="33"></DIV>


      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=36
            src="img/ru/mtdl.png" width=5></TD>
          <TD class=ntitle vAlign=top
          background="mtdbg.png" height=36> Контроль клавиатуры.</TD>
          <TD width=5><IMG height=36
            src="img/ru/mtdr.png"
      width=20></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5 background="ltd.gif"></TD>
          <TD class=news vAlign=top><p>
	Для того, чтобы проверить нажата ли нужная клавиша используется опкод:</p>


<div class="mycode5">
00E1: key_pressed <span class="general1-number">0</span> <span class="general1-number">№клавиши</span></div>
<br>
параметры:<br>
0 – этот параметр не изменяется <br>
№клавиши – номера клавиш от 0 до 19 (клавиша 12 не используется). <br>
<br>

Пример:<br><br>
<div class="mycode5">
<span class="general1-label">:test1</span><br>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms<br>
<span class="general1-reservedword">if</span><br>
00E1: key_pressed <span class="general1-number">0 0</span><br>
004D: jump_if_false <span class="general1-label">@test1</span><br><br>
. . . .<br><br>
&lt;код&gt; <br>
<br>
. . . .</div>
<p>
В примере производим проверку нажата ли клавиша и если нажата то происходит выполнение следующего за проверкой кода. Если есть необходимость производить проверку на одновременное нажатие двух и более кнопок то код будет такой: </p>

<div class="mycode5">
<span class="general1-label">:test1</span><br>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms<br>
<span class="general1-reservedword">if and </span><br>
00E1: key_pressed <span class="general1-number">0 0</span><br>
00E1: key_pressed <span class="general1-number">0 1</span><br>
00E1: key_pressed <span class="general1-number">0 2</span><br>
00E1: key_pressed <span class="general1-number">0 3</span><br>
004D: jump_if_false <span class="general1-label">@test1</span><br><br>
. . . .<br><br>
&lt;код&gt; <br>
<br>
. . . .</div>
<p>
*Замечание. Проверка выполнится только тогда, когда будут одновременно нажаты все клавиши. Поэтому то и нет смысла делать проверку на большое количество клавиш.</p>

<p>
Итак с проверками мы разобрались но осталось несколько вопросов.<br>
Как известно клавиша 0 отвечает за перемещение влево/вправо и это означает, что опкод<br>
<strong>00E1: key_pressed 0 0 </strong><br>
сработает при нажатии как на клавишу влево, так и на клавишу вправо. Как же быть в ситуации если есть необходимость знать какая именно клавиша (левая или правая) нажата? Здесь нам поможет опкод:</p>

<div class="mycode5">
0494: get_joystick_data <span class="general1-number">0</span> <span class="general1-variable">$1213 $1214 $1215 $1216</span></div>
<br>
$1213 – переменная которая отвечает за кнопки влево/вправо (<a href="SCMHELPGTASA5.htm">номер клавиши</a> 0)<br>
$1214 – вверх/вниз (вперед / назад) (<a href="SCMHELPGTASA5.htm">номер клавиши</a> 1)<br>
$1215 – влево/вправо на цифровой клавиатуре (в автомобиле: влево/вправо - клавиши контроля гидравлики )<br>
$1216 - в автомобиле: вверх/вниз - клавиши контроля гидравлики.<br><br>
Здесь необходимо небольшое пояснение.<br>
Например при нажатии клавиши:<br><br>
вправо - $1213 = 128 <br>
влево - $1213 = -128 <br><br>
та же ситуация будет и для остальных переменных данного опкода.<br><br>

Пример:<br>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard();"  ></span>
<TEXTAREA ID="holdtext" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext" class="NON">
<span class="general1-label">:testA</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
0494: get_joystick_data <span class="general1-number">0</span> <span class="general1-variable">$123 $124 $125 $126</span>

<span class="general1-label">:testA_1</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">if </span>
001B: <span class="general1-number">-100</span> > <span class="general1-variable">$123</span> <span class="general1-comment">//если $123 = -128 то соответственно -100 > -128</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@testA_2</span> <span class="general1-comment">// если $123 не равно -128</span>
00BA: text_styled <span class="general1-string">'INTRO_2'</span> <span class="general1-number">2000</span> ms <span class="general1-number">2</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@testA_3</span>

<span class="general1-label">:testA_2</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">if </span>
0019: <span class="general1-variable">$123</span> > <span class="general1-number">100</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@testA_3</span>
00BA: text_styled <span class="general1-string">'INTRO_1'</span> <span class="general1-number">2000</span> ms <span class="general1-number">1</span>

<span class="general1-label">:testA_3</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@testA</span></pre></div>
<br>

Для контроля перемещения мышки применяется вот такой опкод:<br>
<br>

<div class="mycode5">
0A4A: store_joystick_offset_to <span class="general1-variable">21@ 22@</span></div>
<br>
где<br>
21@ - перемещение по оси Х<br>
22@ - перемещение по оси Y<br><br>

Также существует проверка на управление клавиатурой и мышкой:<br><br>

<div class="mycode5">
0A4B: controls_keyboard_and_mouse</div>
<br>
Этот опкод проверяет какое управление установлено в меню настроек.<br><br>

Пример:<br><br>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard1();"  ></span>
<TEXTAREA ID="holdtext1" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext1" class="NON">
<span class="general1-label">:testA</span>
054C: use_GXT_table <span class="general1-string">'CASINO9'</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">if</span>
0A4B: controls_keyboard_and_mouse
 <span class="general1-reservedword">jf</span> <span class="general1-label">@testA_1</span>
0512: permanent_text_box <span class="general1-string">'CAS9_H2'</span> <span class="general1-comment">//если установлено управление джойстиком</span>
<span class="general1-reservedword">jump</span> <span class="general1-label">@testA_2</span>

<span class="general1-label">:testA_1</span>
0512: permanent_text_box <span class="general1-string">'CAS9_H4'</span> <span class="general1-comment">//если установлено управление клавиатурой</span>

<span class="general1-label">:testA_2</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">8000</span> ms
<span class="general1-reservedword">jump</span> <span class="general1-label">@testA</span></pre></div>
<br>
ну и на закуску опкод блокирующий действие клавиши 15<br><br>

<div class="mycode5">
07CC: player <span class="general1-variable">$PLAYER_CHAR</span> disable_key_15 <span class="general1-number">0</span></div>
<br>

0 – включить блокировку<br>
1 – выключить.<br>
<p>См. также статью &quot; <a href="articles20.htm">Проверка нажатия клавиш</a>&quot;</p>
	</TD>
          <TD width=5
        background="rtd.gif"></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=20
            src="img/ru/mtdlbot.png" width=5 border=0></TD>
          <TD align=left
            background="mtdbgbot.png"></TD>
          <TD class=ninfo align=right
          background="mtdbgbot.png">&nbsp;
            </TD>
          <TD width=5><IMG height=20
            src="img/ru/mtdrbot.png" width=5
        border=0></TD></TR></TBODY></TABLE></DIV>
</TD></TR><td width="100%"></TBODY></TABLE>
</TABLE></body></html>
