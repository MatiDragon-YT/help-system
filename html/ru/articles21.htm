<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>Работа с битами переменной.</TITLE>
<link rel="stylesheet" type="text/css" href="../../style/style.css">
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<script language="javascript" type="text/javascript" src="img/ru/clipboard.js"></script>
</HEAD>
<BODY topMargin=0 >
<TABLE
style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: #c0c0c0 1px solid"
height=121 cellSpacing=0 cellPadding=0 width=640>
  <TBODY>
  <TR>
    <TD vAlign=top width="100%"><IMG
      src="img/ru/logo2.jpg" width="640" height="121" border=0 class="conthdr" ></TD>
</TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=640 border=0>
  <TBODY>

  <TD width="100%" height="100%" vAlign=top>
   <DIV><IMG
      src="img/ru/old/articles/articles.png" width="640" height="33"></DIV>


      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=36
            src="img/ru/mtdl.png" width=5></TD>
          <TD class=ntitle vAlign=top
          background="mtdbg.png" height=36> Работа с битами переменной.</TD>
          <TD width=5><IMG height=36
            src="img/ru/mtdr.png"
      width=20></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5 background="ltd.gif"></TD>
          <TD class=news vAlign=top><p>
	Любому человеку, изучавшему основы программирования известно, что число в машинном коде представлено в виде нулей и единиц, то есть в двоичной системе счисления. Минимальной единицей информации в компьютере является бит. Бит может быть либо «выключен», при этом его значение равно нулю, либо «включен», тогда его значение равно единице.<br>

Процессор в РС и по сей день используют 32-битную архитектуру (intel и AMD выпускают процессоры с 64-битной архитектурой, но на данный момент операционные системы толком ее не поддерживают). Биты пронумерованы от 0 до 31 справа на лево:<br>
31 30 29 28 27 ………..5 4 3 2 1 0.<br><br>

К примеру десятичное число 65 будет представлено так:<br> 0000 0000 0000 0000 0000 0000 0100 0001. <br><br>

Ну что ж вернемся к нашим опкодам.<br><br>

Наверное многие задавались вопросом, что же это за такие мудреные команды?</p>
<div class="mycode5">
0004: <span class="general1-variable">$391</span> = <span class="general1-number">0</span> // integer values<br>
<br>

. . . . <br><br>

08BA: set <span class="general1-variable">$391</span> bit <span class="general1-number">0</span> - ?<br><br>

. . . .<br><br>

08C0: clear <span class="general1-variable">$391</span> bit <span class="general1-number">0</span> - ?<br><br>

. . . . <br><br>

08B4: test <span class="general1-variable">$391</span> bit <span class="general1-number">0</span> - ?</div>
<br>
Прировняв переменную $391 к нулю мы, тем самым, установили все 32 бита в ноль.<br>
Следующим опкодом 08BA: set $391 bit 0 мы устанавливаем нулевой бит равным единице, то есть 0000 0000...0000 0001.<br><br>

Для примера напишем такой поток:<br><br>

<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard();"  ></span>
<TEXTAREA ID="holdtext" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext" class="NON">
<span class="general1-label">:TEST1</span>
0004: <span class="general1-variable">$391</span> = <span class="general1-number">0</span> // integer values

<span class="general1-label">:TEST1_1</span>
08BA: set <span class="general1-variable">$391</span> bit <span class="general1-number">0 </span>

<span class="general1-label">:TEST1_2</span>
045A: text_draw_1number <span class="general1-number">20.0 430.0</span> <span class="general1-string">' NUMBER '</span> <span class="general1-variable">$391</span> <span class="general1-comment">// ~1~</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">3000</span>
<span class="general1-reservedword">end_thread</span></pre></div>
<br>
<p>В результате в нижнем левом углу экрана появится цифра <span class="general1-number">1</span>.<br><br>
Для чего это нужно? Предположим что переменная <span class="general1-variable">$391</span> у нас будет отвечать за одежду игрока. К примеру нулевой бит имеет отношение к головному убору или прическе, второй – рубашка, третий – штаны и так далее. Либо каждый бит будет отвечать за различные варианты одежды.
Тогда:</p>
<div class="mycode5">
08BA: set <span class="general1-variable">$391</span> bit <span class="general1-number">0</span> <br>
08BA: set <span class="general1-variable">$391</span> bit <span class="general1-number">1</span> <br>
08BA: set <span class="general1-variable">$391</span> bit <span class="general1-number">2</span></div>
<br>
будет означать что вся эта одежда будет применена к модели игрока.<br>
Перед созданием игрока делаем проверку<br><br>
<div class="mycode5">
<span class="general1-reservedword">if</span><br>
08B4: test <span class="general1-variable">$391</span> bit <span class="general1-number">0</span><br>
 <span class="general1-reservedword">jf</span> <span class="general1-label">@xxx</span></div>
<br>
тем самым мы проверяем равен ли нулевой бит единице.<br>
Опкод 08C0: clear <span class="general1-variable">$391</span> bit <span class="general1-number">0</span> – очишаем нулевой бит переменной, то есть приравниваем его к нулю.

Для примера рассмотрим такой поток:<br>
<br>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard1();"  ></span>
<TEXTAREA ID="holdtext1" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext1" class="NON">
<span class="general1-reservedword">create_thread</span><span class="general1-space"> </span><span class="general1-label">@TEST1

:TEST1
</span><span class="general1-reservedword">thread</span><span class="general1-space"> </span><span class="general1-string">'TEST1'
</span><span class="general1-variable">$391</span><span class="general1-space"> = </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-comment">// integer values

</span><span class="general1-label">:TEST1_18
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space">
</span><span class="general1-reservedword">if</span><span class="general1-space">
00E1: key_pressed </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-number">8</span><span class="general1-space"> </span><span class="general1-comment">//Group CTRL Forward
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_46</span><span class="general1-space">
08BA: set </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">0</span><span class="general1-space">
</span><span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@TEST1_102

:TEST1_46
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0
</span><span class="general1-reservedword">if</span><span class="general1-space">
00E1: key_pressed </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-number">9</span><span class="general1-space"> </span><span class="general1-comment">//Group CTRL back
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_74</span><span class="general1-space">
08BA: set </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">1</span><span class="general1-space">
</span><span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@TEST1_102

:TEST1_74
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space">
</span><span class="general1-reservedword">if</span><span class="general1-space">
00E1: key_pressed </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-number">10</span><span class="general1-space"> </span><span class="general1-comment">//conversation - no
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_102</span><span class="general1-space">
08BA: set </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">2</span><span class="general1-space">

</span><span class="general1-label">:TEST1_102
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0
</span><span class="general1-reservedword">if</span><span class="general1-space">
08B4: test </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-comment">// проверяем равен ли нулевой bit единице
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_235</span><span class="general1-space"> </span><span class="general1-comment">//если нет то переходим на следующую метку
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;PLAYER_TORSO&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;TORSO&quot;</span><span class="general1-symbol">, Torso)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;AFRO&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;AFRO&quot;</span><span class="general1-symbol">, Head)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BBSHORTRED&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BOXINGSHORT&quot;</span><span class="general1-symbol">, Legs)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;COWBOYBOOT2&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BIKER&quot;</span><span class="general1-symbol">, Shoes)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">Build</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">)
</span>0110: clear_player <span class="general1-variable">$PLAYER_CHAR</span> wanted_level
<span class="general1-comment">//А это делаем, для того, чтобы копы игрока не доставали после переодевания</span>
<span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@TEST1_510

:TEST1_235
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space">
</span><span class="general1-reservedword">if</span><span class="general1-space">
08B4: test </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">1</span><span class="general1-space">
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_372
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BBJERSEY&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;SLEEVT&quot;</span><span class="general1-symbol">, Torso)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;GROOVECUT&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;GROOVECUT&quot;</span><span class="general1-symbol">, Head)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;SUIT1TRGANG&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;SUIT1TR&quot;</span><span class="general1-symbol">, Legs)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;SHOEDRESSBRN&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;SHOE&quot;</span><span class="general1-symbol">, Shoes)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">Build</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">)
0110: clear_player <span class="general1-variable">$PLAYER_CHAR</span> wanted_level
</span><span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@TEST1_510

:TEST1_372
</span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space">
</span><span class="general1-reservedword">if</span><span class="general1-space">
08B4: test </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">2</span><span class="general1-space">
</span><span class="general1-reservedword">jf</span><span class="general1-space"> </span><span class="general1-label">@TEST1_510</span><span class="general1-space">
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;TSHIRTERISYELL&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;TSHIRT&quot;</span><span class="general1-symbol">, Torso)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;WEDGE&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;WEDGE&quot;</span><span class="general1-symbol">, Head)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BBSHORTWHT&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;BOXINGSHORT&quot;</span><span class="general1-symbol">, Legs)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">SetClothes</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">, </span><span class="general1-string">&quot;FLIPFLOP&quot;</span><span class="general1-symbol">, </span><span class="general1-string">&quot;FLIPFLOP&quot;</span><span class="general1-symbol">, Shoes)
</span><span class="general1-class">Player</span><span class="general1-symbol">.</span><span class="general1-command">Build</span><span class="general1-symbol">(</span><span class="general1-variable">$PLAYER_CHAR</span><span class="general1-symbol">)
0110: clear_player <span class="general1-variable">$PLAYER_CHAR</span> wanted_level

</span><span class="general1-label">:TEST1_510
</span><span class="general1-symbol">08C0: clear </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">0
</span><span class="general1-symbol">08C0: clear </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">1
</span><span class="general1-symbol">08C0: clear </span><span class="general1-variable">$391</span><span class="general1-space"> bit </span><span class="general1-number">2</span><span class="general1-space">
</span><span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@TEST1_18</span></pre>
</div>
<p><strong>Смотрите пример <a href="examples/bit.txt" target="_blank">здесь</a>.</strong></p>
<p>
 P.S. Надеюсь после прочитанного появилось представление о работе выше перечисленных опкодов. </p>

</TD>
          <TD width=5
        background="rtd.gif"></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=20
            src="img/ru/mtdlbot.png" width=5 border=0></TD>
          <TD align=left
            background="mtdbgbot.png"></TD>
          <TD class=ninfo align=right
          background="mtdbgbot.png">&nbsp;
            </TD>
          <TD width=5><IMG height=20
            src="img/ru/mtdrbot.png" width=5
        border=0></TD></TR></TBODY></TABLE></DIV>
<BR><BR></TD></TR><td width="100%"></TBODY></TABLE>
</TABLE></body></html>
