<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>Работа со звуками в GTA San Andreas</TITLE>
<link rel="stylesheet" type="text/css" href="../../style/style.css">
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<script language="javascript" type="text/javascript" src="img/ru/clipboard.js"></script>
</HEAD>
<BODY topMargin=0 >
<TABLE
style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: #c0c0c0 1px solid"
height=121 cellSpacing=0 cellPadding=0 width=640>
  <TBODY>
  <TR>
    <TD vAlign=top width="100%"><IMG
      src="img/ru/logo2.jpg" width="640" height="121" border=0 class="conthdr" ></TD>
</TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=640 border=0>
  <TBODY>

  <TD width="100%" height="100%" vAlign=top>
   <DIV><IMG
      src="img/ru/old/articles/articles.png" width="640" height="33"></DIV>


      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=36
            src="img/ru/mtdl.png" width=5></TD>
          <TD class=ntitle vAlign=top
          background="mtdbg.png" height=36> Работа со звуками в GTA San Andreas.</TD>
          <TD width=5><IMG height=36
            src="img/ru/mtdr.png"
      width=20></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5 background="ltd.gif"></TD>
          <TD vAlign=top class=news><p>
	Всем наверно известны такие варианты загрузки звуков как: </p>
<div class="mycode5">
03CF: load_wav <span class="general1-number">15863</span> as <span class="general1-number">1</span> <br>
03CF: load_wav <span class="general1-number">15805</span> as <span class="general1-number">2</span> <br>
03CF: load_wav <span class="general1-number">32401</span> as <span class="general1-number">3</span><br>
03CF: load_wav <span class="general1-number">15863</span> as <span class="general1-number">4</span></div>
<br>

при этом<br><br>

<div class="mycode5">
03CF: load_wav <span class="general1-number">15863</span> as <span class="general1-number">1</span> <br>
03CF: load_wav <span class="general1-number">15805</span> as <span class="general1-number">2</span></div>
<br>

чаще всего применяются для загрузки диалогов, а
<br><br>
<div class="mycode5">
03CF: load_wav <span class="general1-number">32401</span> as <span class="general1-number">3</span><br>
03CF: load_wav <span class="general1-number">15863</span> as <span class="general1-number">4</span></div>
<br>

для загрузки игровых звуков.<br><br>

Для проигрыша звука применяется такая команда:<br><br>
<div class="mycode5">
03D1: play_wav <span class="general1-number">1</span> <span class="general1-comment">//2 //3 //4</span></div>
<br>
Ну и соответственно выгрузка звука:<br><br>
<div class="mycode5">
040D: unload_wav <span class="general1-number">1</span> <span class="general1-comment">//2 //3 //4</span></div>
<br><p>
Выгружать звуки нужно обязательно, после их использования, иначе будут проблемы либо звуки вообще не будут воспроизводиться либо будут проигрываться не те, что нужно. <br>
Пример диалога: </p>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard();"  ></span>
<TEXTAREA ID="holdtext" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext" class="NON">
<span class="general1-label">:ZVUK_5800</span>
054C: use_GXT_table <span class="general1-string">'WUZI1'</span>
<span class="general1-comment">//загружаем GXT раздел, необходим для отображения титров</span>
03CF: load_wav <span class="general1-number">36600</span> as<span class="general1-number"> 1</span>
03CF: load_wav <span class="general1-number">36601</span> as <span class="general1-number">2</span>
<span class="general1-label">:ZVUK_5802</span>
<span class="general1-reservedword">if and</span>
 83D0: <span class="general1-reservedword">not</span> wav <span class="general1-number">1</span> loaded <span class="general1-comment">//проверяем загрузку звука</span>
 83D0: <span class="general1-reservedword">not</span> wav <span class="general1-number">2</span> loaded
<span class="general1-reservedword">jf</span> <span class="general1-label">@ZVUK_5803</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">jump</span> <span class="general1-label">@ZVUK_5802</span>

<span class="general1-label">:ZVUK_5803</span>
03D1: play_wav <span class="general1-number">1</span> <span class="general1-comment">//проигрываем звук</span>
00BC: text_highpriority <span class="general1-string">'STL1_AA'</span> <span class="general1-number">10000</span> ms <span class="general1-number">1</span> <span class="general1-comment">//выводим титры</span>
<span class="general1-label">
:ZVUK_5804</span>
<span class="general1-reservedword">if</span>
 03D2: wav <span class="general1-number">1</span> ended <span class="general1-comment">//проверяем, закончился ли проигрыш звука</span>
<span class="general1-reservedword">jf</span> <span class="general1-label">@ZVUK_5805</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">jump</span> <span class="general1-label">@ZVUK_5804</span>

<span class="general1-label">:ZVUK_5805</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">4000</span> ms
03D5: remove_text <span class="general1-string">'STL1_AA'</span> <span class="general1-comment">//удаляем текст</span>
040D: unload_wav <span class="general1-number">1</span> <span class="general1-comment">//удаляем звук</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">550</span> ms
03D1: play_wav <span class="general1-number">2</span>
00BC: text_highpriority <span class="general1-string">'STL1_AB'</span> <span class="general1-number">10000</span> ms <span class="general1-number">1 </span>

<span class="general1-label">:ZVUK_5806</span>
<span class="general1-reservedword">if </span>
 03D2: wav <span class="general1-number">2</span> ended
<span class="general1-reservedword">jf</span> <span class="general1-label">@ZVUK_5807</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">jump</span> <span class="general1-label">@ZVUK_5806</span>

<span class="general1-label">:ZVUK_5807</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">4000</span> ms
03D5: remove_text <span class="general1-string">'STL1_AB'</span>
040D: unload_wav <span class="general1-number">2</span></pre>
</div>
<br>
<p>

Для того чтобы двери, ворота или любой другой объект в игре «зазвучал» применяют такой опкод:</p>
<div class="mycode5">
097B: play_audio_at_object <span class="general1-variable">246@</span> event <span class="general1-number">1126</span><br>
<span class="general1-comment">//проиграть возле объекта 246@ звук 1126</span></div>
<br>
где<br>
<span class="general1-variable">246@</span> - переменная объекта<br>
<span class="general1-number">1126</span> – звук (я так понимаю это код звукового файла, если не прав то знающие люди поправят). <br>
Перечень звуков находится в файле GTA San Andreas\data\AudioEvents.txt.<br>
Но одного этого опкода не достаточно, для того чтобы звук был проигран, необходимо прежде его загрузить.
Здесь как раз и применяется 03CF: load_wav <span class="general1-number">1823</span> as <span class="general1-number">3</span> или as <span class="general1-number">4</span>. <br>
<br>

Пример: <br><br>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard1();"  ></span>
<TEXTAREA ID="holdtext1" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext1" class="NON">
<span class="general1-label">:ZVUK_3786
</span><br><span class="general1-symbol">029B: </span><span class="general1-variable">246@</span><span class="general1-space"> = init_object </span><span class="general1-model">#WAREHOUSE_DOOR2B</span><span class="general1-space"> at </span><span class="general1-number">2774.3611</span><span class="general1-space"> -</span><span class="general1-number">2417.8291</span><span class="general1-space"> </span><span class="general1-number">14.675</span><span class="general1-space">
0400: create_coordinate </span><span class="general1-variable">251@</span><span class="general1-space"> </span><span class="general1-variable">252@</span><span class="general1-space"> </span><span class="general1-variable">253@</span><span class="general1-space"> from_object </span><span class="general1-variable">246@</span><span class="general1-space"> offset </span><span class="general1-number">0.0</span><span class="general1-space"> </span><span class="general1-number">0.0</span><span class="general1-space"> </span><span class="general1-number">4.0
</span><span class="general1-reservedword">var
</span><span class="general1-variable">$muve2</span><span class="general1-space"> : Integer
</span><span class="general1-reservedword">end</span><span class="general1-space"> </span><span class="general1-comment">//end var
</span><span class="general1-variable">$muve2</span><span class="general1-space"> = </span><span class="general1-number">0
</span><span class="general1-symbol">03CF: load_wav </span><span class="general1-number">1823</span><span class="general1-space"> as </span><span class="general1-number">3

</span><span class="general1-label">:ZVUK_3787
</span><span class="general1-symbol">0001: </span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space"> ms
00D6: </span><span class="general1-reservedword">if
</span><span class="general1-symbol">03CA: object </span><span class="general1-variable">246@</span><span class="general1-space"> exists
004D: jump_if_false </span><span class="general1-label">@ZVUK_3789</span><span class="general1-space">
097B: play_audio_at_object</span> <span class="general1-variable">246@</span><span class="general1-space"> event</span> <span class="general1-number">1035</span><span class="general1-space">

</span><span class="general1-label">:ZVUK_3789
</span><span class="general1-symbol">0006: </span><span class="general1-variable">32@</span><span class="general1-space"> = </span><span class="general1-number">0</span><span class="general1-space"> </span><span class="general1-comment">// integer values

</span><span class="general1-label">:ZVUK_3790</span><span class="general1-space">
00D6: </span><span class="general1-reservedword">if</span><span class="general1-space">
001A: </span><span class="general1-number">20</span><span class="general1-space"> &gt; </span><span class="general1-variable">$muve2
</span><span class="general1-symbol">004D: jump_if_false </span><span class="general1-label">@ZVUK_3792
</span><span class="general1-symbol">034E: move_object </span><span class="general1-variable">246@</span><span class="general1-space"> </span><span class="general1-reservedword">to</span><span class="general1-space"> </span><span class="general1-variable">251@</span><span class="general1-space"> </span><span class="general1-variable">252@</span><span class="general1-space"> </span><span class="general1-variable">253@speed</span><span class="general1-space"> </span><span class="general1-number">0.0</span><span class="general1-space"> </span><span class="general1-number">0.0</span><span class="general1-space"> </span><span class="general1-number">0.2</span><span class="general1-space"> flag </span><span class="general1-number">0
</span><span class="general1-space">097B: play_audio_at_object</span> <span class="general1-variable">246@</span><span class="general1-space"> event</span> <span class="general1-number">1035</span><span class="general1-space"> </span><span class="general1-space">
0001: </span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">30</span><span class="general1-space"> ms
</span><span class="general1-variable">$muve2</span><span class="general1-space"> +=</span><span class="general1-number">1
</span><span class="general1-symbol">000A: </span><span class="general1-variable">32@</span><span class="general1-space"> += </span><span class="general1-number">1</span><span class="general1-space"> </span><span class="general1-comment">// integer values
</span><span class="general1-symbol">0001: </span><span class="general1-reservedword">wait</span><span class="general1-space"> </span><span class="general1-number">0</span><span class="general1-space"> ms
0002: </span><span class="general1-reservedword">jump</span><span class="general1-space"> </span><span class="general1-label">@ZVUK_3790

:ZVUK_3792
</span><span class="general1-symbol">00D6: </span><span class="general1-reservedword">if</span><span class="general1-space">
03CA: object </span><span class="general1-variable">246@</span><span class="general1-space"> exists
004D: jump_if_false </span><span class="general1-label">@ZVUK_3793</span><span class="general1-space">
097B: play_audio_at_object</span><span class="general1-symbol"> </span><span class="general1-variable">246@</span><span class="general1-space"> event </span><span class="general1-number">1036

</span><span class="general1-label">:ZVUK_3793
</span><span class="general1-symbol">040D: unload_wav </span><span class="general1-number">3</span><span class="general1-space">
01C4: remove_references_to_object </span><span class="general1-variable">246@
</span><span class="general1-comment">// This object will now disappear when the player looks away </span></pre>
</div><br>

Здесь при перемещении ворот проигрывается звук. <br><br>

Опкод: <br><br>
<div class="mycode5">
097C: attach_wav <span class="general1-number">4</span> to_object <span class="general1-variable">6@</span> <span class="general1-comment">//прикрепить звук 4 к объекту 6@</span></div>
<br>
пример: <br>
<br>
<div  class="imgcursor" align="right"><span class="kbd"><img src="img/ru/ico_cb.gif" alt="Copy to Clipboard" width="16" height="16"  onClick="ClipBoard2();"  ></span>
<TEXTAREA ID="holdtext2" STYLE="display:none;"></TEXTAREA></div>
<div class=mycode5>
<pre id="copytext2" class="NON">
<span class="general1-label">:IMPND_3038</span>
03CF: load_wav <span class="general1-number">36000 </span>as<span class="general1-number"> 4</span> <span class="general1-comment">//загружаем звук 36000 как 4</span>

<span class="general1-label">:IMPND_3076</span>
<span class="general1-reservedword">wait</span> <span class="general1-number">0</span> ms
<span class="general1-reservedword">if</span>
 03D0: wav <span class="general1-number">4</span> loaded
<span class="general1-reservedword">jf</span> <span class="general1-label">@IMPND_3076</span>
097C: attach_wav <span class="general1-number">4</span> to_object <span class="general1-variable">6@</span><span class="general1-comment">//прикрепить звук 4 к объекту 6@</span>
03D1: play_wav <span class="general1-number">4</span> <span class="general1-comment">//проигрываем звук</span>
03D7: set_wav <span class="general1-number">4</span> location <span class="general1-number">1589.0597 -1694.7285 10.4887</span>
<span class="general1-comment">//разместить звук 4 в координатах 1589.0597 -1694.7285 10.4887</span></pre>
</div> <br>

Так же можно присвоить определенный звук и актеру:<br>
<br>
<br>
<div class="mycode5">
09D6: set_actor<span class="general1-reservedword"></span> <span class="general1-variable">1@</span> sound <span class="general1-number">5851</span> flags <span class="general1-number">1 1 0</span> <span class="general1-comment"><br>
// актер 1@ звук 5851 флаг 1 флаг 1 флаг 0</span><br>


09F1: play_audio_at_actor <span class="general1-variable">$PLAYER_ACTOR</span> event <span class="general1-number">1190</span> <br>
<span class="general1-comment">//воспроизвести актеру $PLAYER_ACTOR звук 1190</span></div>
<p>

Можно проиграть определенный звук в заданных координатах.<br>

018C: play_sound <span class="general1-number">1052</span> at <span class="general1-number">0.0 0.0 0.0</span> <span class="general1-comment">// где 0.0 0.0 0.0 – координаты</span><br>
097A: play_audio_at <span class="general1-number">0.0 0.0 0.0</span> event<span class="general1-number"> 1136</span> <span class="general1-comment">//проиграть в координатах 0.0 0.0 0.0 звук 1136</span><br><br>

Присвоить звук автомобилю:<br>
0A16: link_wav <span class="general1-number">3 </span>to_car<span class="general1-variable"> 59@ </span><span class="general1-comment">// прикрепить звук 3 транспорту 59@ </span><br>
03D1: play_wav <span class="general1-number">3</span><br><br>

09F7: play_audio_at_car <span class="general1-variable">$SWEETS_CAR</span> event <span class="general1-number">1147 </span><br><span class="general1-comment">// воспроизвести транспорту $SWEETS_CAR звук 1147.</span><br><br>

Имеются также такие опкоды:<br>
0717: assign_actor <span class="general1-variable">55@</span> to_dialogue_mode <span class="general1-comment">// присвоить актеру 55@ диалог</span><br><br>
0A18: set_dialogue_classA_question_GXT <span class="general1-variable">281@s </span>answer_yes_GXT<span class="general1-variable"> 283@ </span>answer_no_GXT<span class="general1-variable"> 285@s </span>question_WAV<span class="general1-variable"> 291@ </span>answer_yes_WAV<span class="general1-variable"> 292@</span> answer_no_WAV<span class="general1-variable"> 293@</span><br>
<span class="general1-comment">//загрузить текст 281@s текст 283@s текст 285@s звук 291@ звук 292@ звук 293@</span><br><br>
0A3C: set_dialogue_classA_end_GXT <span class="general1-variable">285@s</span> WAV<span class="general1-variable"> 297@</span> <span class="general1-comment">//загрузить текст 285@s звук 297@</span><br><br>
0719:  toggle_dialogue_mode <span class="general1-comment">//воспроизвести диалог</span><br>
<br>

Еще такая тройка опкодов:<br>
0952: load_soundtrack <span class="general1-number">0</span><span class="general1-comment"> //загрузить мелодию 0 </span><span class="mytext"><br>
</span><span class="general1-comment">// (0,1, 2, 3…с числами можно поэкспериментировать)</span><br>
0954: start_playing_loaded_soundtrack<strong> </strong><span class="general1-comment">// проиграть загруженную мелодию</span><br>
0955: end_playing_loaded_soundtrack <span class="general1-comment">// остановить и выгрузить мелодию</span></p>
<p>
 Вот вкратце все то, что мне удалось выяснить.
</p></TD>
          <TD width=5
        background="rtd.gif"></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD width=5><IMG height=20
            src="img/ru/mtdlbot.png" width=5 border=0></TD>
          <TD align=left
            background="mtdbgbot.png"></TD>
          <TD class=ninfo align=right
          background="mtdbgbot.png">&nbsp;
            </TD>
          <TD width=5><IMG height=20
            src="img/ru/mtdrbot.png" width=5
        border=0></TD></TR></TBODY></TABLE></DIV>
<BR><BR></TD></TR><td width="100%"></TBODY></TABLE>
</TABLE></body></html>
